package com.chainsys.jdbcprogram;

import java.sql.*;

public class Jdbc_rsmd {

    public static void main(String args[]) throws Exception {
    	ResultSetMetaDataDemo();
    }

    public static void ResultSetMetaDataDemo() {
        try {
            Class.forName("oracle.jdbc.driver.OracleDriver");
            Connection con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", "system",
                    "Chennai268$");

            PreparedStatement ps = con.prepareStatement("select * from emp");
            ResultSet rs = ps.executeQuery();
            ResultSetMetaData rsmd = rs.getMetaData();
            int r= rsmd.getColumnCount();
            System.out.println("Total columns: " + r);
            int i=1;
            while(i<r+1) {
            System.out.println("Column Name of column("+i+"): " + rsmd.getColumnName(i));
            System.out.println("Column Type Name of column("+i+"): " + rsmd.getColumnTypeName(i));
            i++;
            }
            con.close();
        } catch (Exception e) {
            System.out.println(e);
        }
    }
}